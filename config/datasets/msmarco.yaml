# =============================================================================
# MS MARCO Dataset Configuration (FIXED - with subset support)
# =============================================================================
# Microsoft Machine Reading Comprehension passage embeddings
# Source: https://microsoft.github.io/msmarco/
# =============================================================================

dataset:
  name: "msmarco"
  display_name: "MS MARCO"
  description: "MS MARCO passage embeddings (configurable subset)"
  type: "text_embeddings"

# -----------------------------------------------------------------------------
# Data Specifications - DEFAULT TO SMALL SUBSET FOR TESTING
# -----------------------------------------------------------------------------
specs:
  # Full dataset size (for reference)
  full_size: 8841823

  # ACTUAL SIZE TO USE (configurable)
  num_vectors: 100000  # Start with 100K for testing
  num_queries: 1000    # Reduced for faster testing
  dimensions: 768
  data_type: "float32"
  ground_truth_k: 100

# -----------------------------------------------------------------------------
# Subset Configuration
# -----------------------------------------------------------------------------
# Control how many passages to use
subset_size: 100000  # 100K passages (~10 minutes to generate embeddings)

# Preset subset sizes for different use cases
presets:
  tiny: 10000      # ~1 minute - quick testing
  small: 50000     # ~5 minutes - basic benchmarking
  medium: 100000   # ~10 minutes - default
  large: 500000    # ~50 minutes - more thorough
  full: 8841823    # ~7+ hours - production

# -----------------------------------------------------------------------------
# Distance Metric
# -----------------------------------------------------------------------------
distance:
  metric: "cosine"  # or "ip" for inner product
  normalize: true

# -----------------------------------------------------------------------------
# Download Configuration
# -----------------------------------------------------------------------------
download:
  source: "beir"
  base_url: "https://public.ukp.informatik.tu-darmstadt.de/thakur/BEIR/datasets"
  file: "msmarco.zip"
  size_mb: 500

# -----------------------------------------------------------------------------
# Embedding Model Configuration
# -----------------------------------------------------------------------------
embedding:
  model: "sentence-transformers/msmarco-distilbert-base-v4"
  batch_size: 32
  normalize: true
  cache_embeddings: true  # Save generated embeddings for reuse

# -----------------------------------------------------------------------------
# File Format
# -----------------------------------------------------------------------------
format:
  type: "jsonl"
  description: "JSON Lines with text passages"

# -----------------------------------------------------------------------------
# Subsets for Scalability Testing
# -----------------------------------------------------------------------------
subsets:
  - name: "msmarco10k"
    size: 10000
    description: "10K passages for quick testing"
  - name: "msmarco50k"
    size: 50000
    description: "50K passages for basic benchmarking"
  - name: "msmarco100k"
    size: 100000
    description: "100K passages (default)"
  - name: "msmarco500k"
    size: 500000
    description: "500K passages for thorough testing"
  - name: "msmarco_full"
    size: 8841823
    description: "Full dataset (use only if needed)"

# -----------------------------------------------------------------------------
# Query Sets
# -----------------------------------------------------------------------------
query_sets:
  default: 1000      # Use 1000 queries by default
  dev: 6980         # Full dev set (optional)

# -----------------------------------------------------------------------------
# Performance Notes
# -----------------------------------------------------------------------------
notes:
  - "Default subset size is 100K passages (~10 min to generate embeddings)"
  - "Embeddings are cached after first generation"
  - "Use 'tiny' preset (10K) for quick testing"
  - "Full dataset (8.8M) requires 7+ hours and 20+ GB disk space"
  - "Requires sentence-transformers: pip install sentence-transformers"

# -----------------------------------------------------------------------------
# Metadata (from passages)
# -----------------------------------------------------------------------------
metadata:
  generate: false
  fields:
    passage_id:
      type: "string"
      source: "dataset"

# -----------------------------------------------------------------------------
# Reference Papers
# -----------------------------------------------------------------------------
references:
  - title: "MS MARCO: A Human Generated MAchine Reading COmprehension Dataset"
    authors: "Nguyen et al."
    venue: "NeurIPS 2016 Workshop"
    url: "https://arxiv.org/abs/1611.09268"